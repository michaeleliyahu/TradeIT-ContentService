# Content service compose file
# Requires shared infrastructure: run 'docker-compose up -d' from TradeIT root first

services:
  content-service:
    build: .
    container_name: content-service
    env_file:
      - .env
    environment:
      - RABBITMQ_URL=amqp://guest:guest@tradeit-rabbitmq:5672/
    ports:
      - "8003:8000"
    depends_on:
      - content-db
    networks:
      - tradeit-network
      - default
    restart: on-failure

  content-db:
    image: postgres:15
    container_name: content-db
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
      POSTGRES_DB: content_db
    ports:
      - "5435:5432"  # Different port - 5434 is used by post-service
    volumes:
      - content-db-data:/var/lib/postgresql/data

networks:
  tradeit-network:
    external: true

volumes:
  content-db-data:
